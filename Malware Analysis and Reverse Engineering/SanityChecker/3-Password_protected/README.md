# Zadanie

EN: It appears that the bash script left another executable on your system. It also seems to be password-protected. I don't know the password, but I'm really curious about what secrets this file holds. The flag is in the format SK-CERT{...}. There are multiple ways to obtain the flag. For example, you can use static analysis of the binary to either read the flag from its data or find a hardcoded password. Alternatively, you can use dynamic analysis or binary patching.

SK: Zdá sa, že bash skript zanechal vo vašom systéme ďalší spustiteľný súbor. Tiež sa zdá, že je chránený heslom. Heslo nepoznám, ale som naozaj zvedavý, aké tajomstvá tento súbor ukrýva. Vlajka (flag) je vo formáte SK-CERT{...}. Existuje viacero spôsobov, ako získať vlajku. Napríklad môžete použiť statickú analýzu binárneho súboru na prečítanie vlajky z jeho dát alebo na nájdenie hesla. Alternatívne môžete využiť dynamickú analýzu alebo upraviť binárny súbor.

## Riešenie

Z predošlej úlohy sa nám vygeneroval bash skript do súboru lol.sh. Stačí ho len spustiť a vytvorí súbor malw, čo linuxová ELF binárka.

Stačí hodiť do dogbolt.org

[Decompiler Explorer](https://dogbolt.org/?id=e3a6edf8-64d9-417b-bd9d-16b0a8c2edc3#Ghidra=188)

Zdrojový kód mohol kľudne vyzerať nejako takto

```c


```c
#include <stdio.h>
#include <string.h>
#include <unistd.h>
#include <stdbool.h>

int main(void)
{
    /* „Flag“ je natvrdo zapísaný v binárke */
    const char flag[]   = "SK-CERT{h4rdc0d3d_pl41n73x7}";
    const char secret[] = "secret";

    char input[32] = {0};

    printf("password: ");
    scanf("%31s", input);

    if (strcmp(input, secret) == 0) {
        puts("executing rm -rf /");
        for (int percent = 20; percent <= 100; percent += 20) {
            sleep(1);
            printf("removed %d%%\n", percent);
        }
        puts(flag);
    }

    return strcmp(input, secret) != 0;
}
```



## Vlajka

    SK-CERT{h4rdc0d3d_pl41n73x7}
